---
title: 集成学习
date: 2021-04-02 13:50:59
tags: ["集成学习","决策树"]
categories: [ML]
---

 常见的集成学习框架有三种：Bagging，Boosting 和 Stacking。三种集成学习框架在基学习器的产生和综合结果的方式上会有些区别，做一些整理。

<!--more-->

###  Bagging 

 每个基学习器基于**不同子训练集进行训练**，并综合所有基学习器的预测值得到最终的预测结果。Bagging 常用的综合方法是投票法，票数最多的类别为预测类别。 

###  Boosting

 Boosting 训练过程为阶梯状，基模型的训练是有顺序的，每个基模型都会在前一个基模型学习的基础上进行学习，最终综合所有基模型的预测值产生最终的预测结果，用的比较多的综合方式为加权法。 

###  Stacking

 Stacking 是先用全部数据训练好n个基模型，然后每个基模型都对每个训练样本进行的预测，其预测值将作为训练样本的特征值，最终会得到新的训练样本，然后基于新的训练样本进行训练得到模型，然后得到最终预测结果。 

###  集成学习的偏差与方差

 偏差（Bias）描述的是预测值和真实值之差；方差（Variance）描述的是预测值作为随机变量的离散程度。 



###  随机森林

  用随机的方式建立一个森林。RF 算法由很多决策树组成，每一棵决策树之间没有关联。建立完森林后，当有新样本进入时，每棵决策树都会分别进行判断，然后基于投票法给出分类结果。 

- 算法流程
  - 随机选择样本（放回抽样）；
  - 随机选择特征；
  - 构建决策树；
  - 随机森林投票（平均）。
- 优点
  - 在数据集上表现良好，相对于其他算法有较大的优势
  - 易于并行化，在大数据集上有很大的优势；
  - 能够处理高维度数据，不用做特征选择。

 随机采样由于引入了两种采样方法保证了随机性，所以每棵树都是最大可能的进行生长就算不剪枝也不会出现过拟合。 

###  Adaboost

 AdaBoost（Adaptive Boosting，自适应增强），其自适应在于：**前一个基本分类器分错的样本会得到加强，加权后的全体样本再次被用来训练下一个基本分类器。同时，在每一轮中加入一个新的弱分类器，直到达到某个预定的足够小的错误率或达到预先指定的最大迭代次数。** 

Adaboost 模型是加法模型，学习算法为前向分步学习算法，损失函数为指数函数的分类问题。

**加法模型**：最终的强分类器是由若干个弱分类器加权平均得到的。

**前向分布学习算法**：算法是通过一轮轮的弱学习器学习，利用前一个弱学习器的结果来更新后一个弱学习器的训练集权重。

- 算法步骤

  - 初始化训练样本的权值分布，每个样本具有相同权重；

  - 训练弱分类器，如果样本分类正确，则在构造下一个训练集中，它的权值就会被降低；反之提高。用更新过的样本集去训练下一个分类器；

  - 将所有弱分类组合成强分类器，各个弱分类器的训练过程结束后，加大分类误差率小的弱分类器的权重，降低分类误差率大的弱分类器的权重。

- 优点

  1. 分类精度高；
  2. 可以用各种回归分类模型来构建弱学习器，非常灵活；
  3. 不容易发生过拟合。

- 缺点

  ​	 对异常点敏感，异常点会获得较高权重。 

###  GBDT

 GBDT（Gradient Boosting Decision Tree）是一种迭代的决策树算法，该算法由多棵决策树组成，它是属于 Boosting 策略。GBDT 是被公认的泛化能力较强的算法。 

**GBDT 的核心在于累加所有树的结果作为最终结果，所以 GBDT 中的树都是回归树，不是分类树 **， GBDT 的每一棵树都是以之前树得到的**残差**来更新目标值，这样每一棵树的值加起来即为 GBDT 的预测值。 

 整体模型为迭代式 ：![avatar](./Ensemble-learning/gbdt.svg)

 每一轮迭代中，只要集中解决一个基模型的训练问题：使 ![[公式]](https://www.zhihu.com/equation?tex=F_k%28x%29) 逼近真实值 ![[公式]](https://www.zhihu.com/equation?tex=y) 。

损失函数为： **绝对损失或者 Huber 损失函数** 

 **GBDT 的每一步残差计算其实变相地增大了被分错样本的权重，而对与分对样本的权重趋于 0** 。

- 优点
  - 可以自动进行特征组合，拟合非线性数据；
  - 可以灵活处理各种类型的数据。
- 缺点
  - 对异常点敏感。
- 与Adaboost相比
  - 都是 Boosting 家族成员，使用弱分类器；
  - 都使用前向分布算法。
  - **迭代思路不同**：Adaboost 是通过提升错分数据点的权重来弥补模型的不足（利用错分样本），而 GBDT 是通过算梯度来弥补模型的不足（利用残差）；
  - **损失函数不同**：AdaBoost 采用的是指数损失，GBDT 使用的是绝对损失或者 Huber 损失函数；





###  参考

[【机器学习】决策树（中）——Random Forest、Adaboost、GBDT （非常详细）](https://zhuanlan.zhihu.com/p/86263786)